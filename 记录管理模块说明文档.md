## 记录管理模块说明文档

范轩玮 刘佳阳

项目地址：https://github.com/jiayang-16/DBProject113b

### 一、结构

| 类名          | 功能                                                         |
| ------------- | ------------------------------------------------------------ |
| RM_Manager    | 调用FileManager中的接口实现文件的新建、打开、关闭、删除      |
| RID           | 实现记录的唯一标记，储存页号+记录编号                        |
| PageHead      | 实现文件信息（储存在文件第一页）的定义，包括记录长度、每页最大记录数、存在记录总数、存在页数、每页的空闲情况 |
| RM_FileHandle | 在RM_Manager中使用，实现记录的获取、插入、删除、更新         |
| RM_FileScan   | 在文件中查找满足条件的记录（尚未实现）                       |
| RM_Record     | 储存记录（RID+记录内容)                                      |

### 二、具体实现

1. #### 记录的存储方式

   记录在代码中以struct的方式实现，内容根据不同的文件可以不同。

   记录在文件中存储为二进制文件。通过对struct中的成员变量进行序列化操作，将其以约定的顺序转换为BufType数组，再存入文件。从文件中读出时再以约定的顺序转回原本的成员变量。

2. #### 空闲地址的记录方式

   在文件的第一页以BitMap的方式存储每页的空闲情况，在每页的页头以BitMap的方式存储本页记录的空闲情况。读取的时候采用先读出空闲页，再跳转到对应的区域的二级跳转方式。

### 三、工作计划

1. 建立errorCode类，便于debug
2. 完善记录模块工作
3. 建立索引模块

